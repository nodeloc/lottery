{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@nodeloc/lottery/webpack/bootstrap","webpack://@nodeloc/lottery/webpack/runtime/compat get default export","webpack://@nodeloc/lottery/webpack/runtime/define property getters","webpack://@nodeloc/lottery/webpack/runtime/hasOwnProperty shorthand","webpack://@nodeloc/lottery/webpack/runtime/make namespace object","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/app']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/extend']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Badge']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/DiscussionList']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/models/Discussion']\"","webpack://@nodeloc/lottery/./src/forum/addDiscussionBadge.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/utils/classList']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/DiscussionComposer']\"","webpack://@nodeloc/lottery/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@nodeloc/lottery/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/ReplyComposer']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Button']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/utils/ItemList']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/utils/Stream']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/utils/extractText']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Select']\"","webpack://@nodeloc/lottery/./src/forum/components/CreateLotteryModal.js","webpack://@nodeloc/lottery/./src/forum/addComposerItems.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/CommentPost']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/Component']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/LogInModal']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/helpers/avatar']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/helpers/username']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Link']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@nodeloc/lottery/./src/forum/components/ListLotteryModal.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/components/Tooltip']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/helpers/icon']\"","webpack://@nodeloc/lottery/./src/forum/components/EditLotteryModal.js","webpack://@nodeloc/lottery/./src/forum/components/EventCountDown.js","webpack://@nodeloc/lottery/./src/forum/components/PostLottery.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/DiscussionPage']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/utils/PostControls']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['forum/components/Notification']\"","webpack://@nodeloc/lottery/./src/forum/components/FailLotteryNotification.js","webpack://@nodeloc/lottery/./src/forum/components/FinishLotteryNotification.js","webpack://@nodeloc/lottery/./src/forum/components/DrawLotteryNotification.js","webpack://@nodeloc/lottery/./src/forum/components/index.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/Model']\"","webpack://@nodeloc/lottery/./src/forum/models/Lottery.js","webpack://@nodeloc/lottery/./src/forum/models/LotteryOption.js","webpack://@nodeloc/lottery/./src/forum/models/LotteryParticipants.js","webpack://@nodeloc/lottery/./src/forum/models/index.js","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/extenders']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/models/Post']\"","webpack://@nodeloc/lottery/external root \"flarum.core.compat['common/models/Forum']\"","webpack://@nodeloc/lottery/./src/forum/extend.js","webpack://@nodeloc/lottery/./src/forum/index.js","webpack://@nodeloc/lottery/./src/forum/addLotteryToPost.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Badge'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Discussion'];","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport Badge from 'flarum/common/components/Badge';\nimport DiscussionList from 'flarum/forum/components/DiscussionList';\nimport Discussion from 'flarum/common/models/Discussion';\n\nexport default () => {\n  extend(DiscussionList.prototype, 'requestParams', (params) => {\n    params.include.push('firstPost.lottery');\n  });\n\n  extend(Discussion.prototype, 'badges', function (badges) {\n    if (this.hasLottery()) {\n      badges.add(\n        'lottery',\n        Badge.component({\n          type: 'lottery',\n          label: app.translator.trans('nodeloc-lottery.forum.tooltip.badge'),\n          icon: 'fas fa-gift',\n        }),\n        5\n      );\n    }\n  });\n};\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/classList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionComposer'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/ReplyComposer'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/ItemList'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/Stream'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/extractText'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Select'];","import app from 'flarum/forum/app';\r\n\r\nimport Button from 'flarum/common/components/Button';\r\nimport Modal from 'flarum/common/components/Modal';\r\nimport Switch from 'flarum/common/components/Switch';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport extractText from 'flarum/common/utils/extractText';\r\nimport Select from \"flarum/common/components/Select\";\r\n\r\nexport default class CreateLotteryModal extends Modal {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.operator_type = [Stream('discussions_started')];\r\n    this.operator = [Stream('1')];\r\n    this.operator_value = [Stream('1')];\r\n\r\n    this.prizes = Stream('');\r\n    this.price = Stream('');\r\n    this.amount = Stream('');\r\n    this.endDate = Stream();\r\n\r\n    this.allowCancleEnter = Stream(true);\r\n    this.min_participants = Stream(0);\r\n    this.max_participants = Stream(999999);\r\n\r\n    this.datepickerMinDate = this.formatDate(undefined);\r\n\r\n    const {lottery} = this.attrs;\r\n\r\n    // When re-opening the modal for the same discussion composer where we already set lottery attributes\r\n    if (lottery && Array.isArray(lottery.options)) {\r\n      this.operator_type = [];\r\n      this.operator = [];\r\n      this.operator_value = [];\r\n      lottery.options.forEach((option) => {\r\n        this.operator_type.push(Stream(option.operator_type));\r\n        this.operator.push(Stream(option.operator));\r\n        this.operator_value.push(Stream(option.operator_value));\r\n      });\r\n\r\n      this.prizes(lottery.prizes);\r\n      this.price(lottery.price);\r\n      this.amount(lottery.amount);\r\n      this.allowCancleEnter(lottery.allowCancleEnter);\r\n      this.min_participants(lottery.min_participants || 0);\r\n      this.max_participants(lottery.max_participants || 999999);\r\n\r\n      this.endDate(this.formatDate(lottery.endDate));\r\n\r\n      // Replace minimum of 'today' for lottery end date only if the lottery is not already closed\r\n      if (this.endDate() && dayjs(lottery.endDate).isAfter(dayjs())) {\r\n        this.datepickerMinDate = this.formatDate(lottery.endDate);\r\n      }\r\n    }\r\n  }\r\n\r\n  title() {\r\n    return app.translator.trans('nodeloc-lottery.forum.modal.add_title');\r\n  }\r\n\r\n  className() {\r\n    return 'LotteryDiscussionModal Modal--medium';\r\n  }\r\n\r\n  content() {\r\n    return [\r\n      <div className=\"Modal-body\">\r\n        <div className=\"LotteryDiscussionModal-form\">{this.fields().toArray()}</div>\r\n      </div>,\r\n    ];\r\n  }\r\n\r\n  fields() {\r\n    const items = new ItemList();\r\n\r\n    items.add(\r\n      'prizes',\r\n      <div className=\"Form-group\">\r\n        <label\r\n          className=\"label\">{app.translator.trans('nodeloc-lottery.forum.modal.lottery_placeholder')}</label>\r\n        <input type=\"text\" name=\"prizes\" className=\"FormControl\" bidi={this.prizes}/>\r\n      </div>,\r\n      100\r\n    );\r\n    items.add(\r\n      'price',\r\n      <div className=\"Form-group\">\r\n        <label\r\n          className=\"label\">{app.translator.trans('nodeloc-lottery.forum.modal.price')}</label>\r\n\r\n        <input type=\"number\" min=\"1\" name=\"price\" className=\"FormControl\" bidi={this.price}/>\r\n      </div>,\r\n      100\r\n    );\r\n    items.add(\r\n      'amount',\r\n      <div className=\"Form-group\">\r\n        <label\r\n          className=\"label\">{app.translator.trans('nodeloc-lottery.forum.modal.amount')}</label>\r\n\r\n        <input type=\"number\" min=\"1\" name=\"amount\" className=\"FormControl\" bidi={this.amount}/>\r\n      </div>,\r\n      100\r\n    );\r\n\r\n    items.add(\r\n      'conditions',\r\n      <div className=\"LotteryModal--answers Form-group\">\r\n        <label className=\"label LotteryModal--answers-title\">\r\n          <span>{app.translator.trans('nodeloc-lottery.forum.modal.options_label')}</span>\r\n\r\n          {Button.component({\r\n            className: 'Button LotteryModal--button small',\r\n            icon: 'fas fa-plus',\r\n            onclick: this.addOption.bind(this),\r\n          })}\r\n        </label>\r\n\r\n        {this.displayOptions()}\r\n      </div>,\r\n      80\r\n    );\r\n\r\n    items.add(\r\n      'date',\r\n      <div className=\"Form-group\">\r\n        <label className=\"label\">{app.translator.trans('nodeloc-lottery.forum.modal.date_placeholder')}</label>\r\n\r\n        <div className=\"LotteryModal--date\">\r\n          <input\r\n            className=\"FormControl\"\r\n            type=\"datetime-local\"\r\n            name=\"date\"\r\n            bidi={this.endDate}\r\n            min={this.datepickerMinDate}\r\n            max={this.formatDate('2038')}\r\n          />\r\n          {Button.component({\r\n            className: 'Button LotteryModal--button',\r\n            icon: 'fas fa-times',\r\n            onclick: this.endDate.bind(this, null),\r\n          })}\r\n        </div>\r\n\r\n        {this.endDate() && (\r\n          <p className=\"helpText\">\r\n            <i class=\"icon fas fa-clock\"/>\r\n            &nbsp;\r\n            {dayjs(this.endDate()).isBefore(dayjs())\r\n              ? app.translator.trans('nodeloc-lottery.forum.lottery_ended')\r\n              : app.translator.trans('nodeloc-lottery.forum.days_remaining', {time: dayjs(this.endDate()).fromNow()})}\r\n          </p>\r\n        )}\r\n      </div>,\r\n      40\r\n    );\r\n\r\n    items.add(\r\n      'min-participants',\r\n      <div className=\"Form-group MinMaxSelector\">\r\n        <label\r\n          className=\"label\">{app.translator.trans('nodeloc-lottery.forum.modal.participants_help')}</label>\r\n        <div class=\"MinMaxSelector--inputs\">\r\n          <input type=\"number\" min=\"0\" name=\"min_participants\" className=\"FormControl\"\r\n                 bidi={this.min_participants}/>\r\n          <button class=\"Button hasIcon\" type=\"button\">\r\n            <i aria-hidden=\"true\" class=\"icon fas fa-less-than-equal Button-icon\"></i><span\r\n            class=\"Button-label\"></span></button>\r\n          <input class=\"FormControl MinMaxSelector--placeholder\" disabled\r\n                 placeholder={app.translator.trans('nodeloc-lottery.forum.modal.participants_label')}/>\r\n          <button class=\"Button hasIcon\" type=\"button\"><i aria-hidden=\"true\"\r\n                                                          class=\"icon fas fa-less-than-equal Button-icon\"></i><span\r\n            class=\"Button-label\"></span></button>\r\n          <input type=\"number\" max=\"999999\" name=\"max_participants\" className=\"FormControl\"\r\n                 bidi={this.max_participants}/>\r\n        </div>\r\n      </div>,\r\n      15\r\n    );\r\n\r\n    items.add(\r\n      'submit',\r\n      <div className=\"Form-group\">\r\n        {Button.component(\r\n          {\r\n            type: 'submit',\r\n            className: 'Button Button--primary LotteryModal-SubmitButton',\r\n            loading: this.loading,\r\n          },\r\n          app.translator.trans('nodeloc-lottery.forum.modal.submit')\r\n        )}\r\n      </div>,\r\n      -10\r\n    );\r\n\r\n    return items;\r\n  }\r\n\r\n  select_options = {\r\n    discussions_started: app.translator.trans('nodeloc-lottery.forum.modal.discussions_started'),\r\n    posts_made: app.translator.trans('nodeloc-lottery.forum.modal.posts_made'),\r\n    //likes_received: app.translator.trans('nodeloc-lottery.forum.modal.likes_received'),\r\n    //best_answers: app.translator.trans('nodeloc-lottery.forum.modal.best_answers'),\r\n    //moderator_strikes: app.translator.trans('nodeloc-lottery.forum.modal.moderator_strikes'),\r\n    money: app.translator.trans('nodeloc-lottery.forum.modal.money'),\r\n    lotteries_made: app.translator.trans('nodeloc-lottery.forum.modal.lotteries_made'),\r\n  };\r\n\r\n  displayOptions() {\r\n    return Object.keys(this.operator_value).map((el, i) => (\r\n      <div className=\"Form-group MinMaxSelector\">\r\n        <fieldset className=\"MinMaxSelector--inputs\">\r\n          <span class=\"Select\">\r\n            {Select.component({\r\n              options: this.select_options,\r\n              value: this.operator_type[i](),\r\n              onchange: (value) => {\r\n                this.operator_type[i](value);\r\n                //m.redraw();  // 手动调用 redraw\r\n              },\r\n            })}\r\n            <i aria-hidden=\"true\" class=\"icon fas fa-sort Select-caret\"></i></span>\r\n          <button class=\"Button hasIcon\" type=\"button\"\r\n                  onclick={() => this.operator[i](this.operator[i]() === 0 ? 1 : 0)}>\r\n            {this.operator[i]() === 0 ? (\r\n              <i aria-hidden=\"true\" class=\"icon fas fa-less-than-equal Button-icon\"></i>\r\n            ) : (\r\n              <i aria-hidden=\"true\" class=\"icon fas fa-greater-than-equal Button-icon\"></i>\r\n            )}\r\n            <span class=\"Button-label\"></span>\r\n          </button>\r\n\r\n          <input\r\n            className=\"FormControl\"\r\n            type=\"number\"\r\n            name={'operatorvalue' + (i + 1)}\r\n            bidi={this.operator_value[i]}\r\n            placeholder={app.translator.trans('nodeloc-lottery.forum.modal.option_placeholder') + ' #' + (i + 1)}\r\n          />\r\n        </fieldset>\r\n        {i >= 2\r\n          ? Button.component({\r\n            type: 'button',\r\n            className: 'Button Button--warning LotteryModal--button',\r\n            icon: 'fas fa-minus',\r\n            onclick: i >= 1 ? this.removeOption.bind(this, i) : '',\r\n          })\r\n          : ''}\r\n      </div>\r\n    ));\r\n  }\r\n\r\n  addOption() {\r\n    const max = 5;\r\n\r\n    if (this.operator_value.length < max) {\r\n      this.operator_type.push(Stream('money'));\r\n      this.operator.push(Stream('1'));\r\n      this.operator_value.push(Stream('1'));\r\n    } else {\r\n      alert(extractText(app.translator.trans('nodeloc-lottery.forum.modal.max', {max})));\r\n    }\r\n  }\r\n\r\n  removeOption(option) {\r\n    this.operator_type.splice(option, 1);\r\n    this.operator.splice(option, 1);\r\n    this.operator_value.splice(option, 1);\r\n  }\r\n\r\n  data() {\r\n    const lottery = {\r\n      prizes: this.prizes(),\r\n      price: this.price(),\r\n      amount: this.amount(),\r\n      endDate: this.dateToTimestamp(this.endDate()),\r\n      allowCancelEnter: this.allowCancleEnter(),\r\n      min_participants: this.min_participants(),\r\n      max_participants: this.max_participants(),\r\n      options: [],\r\n    };\r\n    this.operator_value.forEach((opvalue, index) => {\r\n      if (opvalue()) {\r\n        lottery.options.push({\r\n          operator_type: this.operator_type[index](),\r\n          operator: this.operator[index](),\r\n          operator_value: opvalue(),\r\n        });\r\n      }\r\n    });\r\n\r\n    if (this.prizes() === '') {\r\n      alert(app.translator.trans('nodeloc-lottery.forum.modal.include_prizes'));\r\n      return null;\r\n    }\r\n    if (this.price() === '') {\r\n      alert(app.translator.trans('nodeloc-lottery.forum.modal.include_price'));\r\n      return null;\r\n    }\r\n    if (this.amount() === '') {\r\n      alert(app.translator.trans('nodeloc-lottery.forum.modal.include_amount'));\r\n      return null;\r\n    }\r\n\r\n    if (lottery.options.length < 1) {\r\n      alert(app.translator.trans('nodeloc-lottery.forum.modal.min'));\r\n\r\n      return null;\r\n    }\r\n    if (this.endDate() === '') {\r\n      alert(app.translator.trans('nodeloc-lottery.forum.modal.include_end_date'));\r\n      return null;\r\n    }\r\n    return lottery;\r\n  }\r\n\r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    const data = this.data();\r\n\r\n    if (data === null) {\r\n      return;\r\n    }\r\n    const promise = this.attrs.onsubmit(data);\r\n\r\n    if (promise instanceof Promise) {\r\n      this.loading = true;\r\n\r\n      promise.then(this.hide.bind(this), (err) => {\r\n        console.error(err);\r\n        this.onerror(err);\r\n        this.loaded();\r\n      });\r\n    } else {\r\n      app.modal.close();\r\n    }\r\n  }\r\n\r\n  formatDate(date, def = false) {\r\n    const dayjsDate = dayjs(date);\r\n\r\n    if (date === false || !dayjsDate.isValid()) return def !== false ? this.formatDate(def) : null;\r\n\r\n    return dayjsDate.format('YYYY-MM-DDTHH:mm');\r\n  }\r\n\r\n  dateToTimestamp(date) {\r\n    const dayjsDate = dayjs(date);\r\n\r\n    if (!date || !dayjsDate.isValid()) return false;\r\n\r\n    return dayjsDate.format();\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\n\r\nimport { extend } from 'flarum/common/extend';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport DiscussionComposer from 'flarum/forum/components/DiscussionComposer';\r\nimport ReplyComposer from 'flarum/forum/components/ReplyComposer';\r\n\r\nimport CreateLotteryModal from './components/CreateLotteryModal';\r\n\r\nexport const addToComposer = (composer) => {\r\n  composer.prototype.addLottery = function () {\r\n    app.modal.show(CreateLotteryModal, {\r\n      lottery: this.composer.fields.lottery,\r\n      onsubmit: (lottery) => (this.composer.fields.lottery = lottery),\r\n    });\r\n  };\r\n\r\n  // Add button to DiscussionComposer header\r\n  extend(composer.prototype, 'headerItems', function (items) {\r\n    const discussion = this.composer.body?.attrs?.discussion;\r\n    const canStartLottery = discussion?.canStartLottery() ?? app.forum.canStartLottery();\r\n    if (canStartLottery) {\r\n      items.add(\r\n        'lottery',\r\n        <a className=\"ComposerBody-lottery\" onclick={this.addLottery.bind(this)}>\r\n          <span className={classList('LotteryLabel', !this.composer.fields.lottery && 'none')}>\r\n            {app.translator.trans(`nodeloc-lottery.forum.composer_discussion.${this.composer.fields.lottery ? 'edit' : 'add'}_lottery`)}\r\n          </span>\r\n        </a>,\r\n        1\r\n      );\r\n    }\r\n  });\r\n\r\n  extend(composer.prototype, 'data', function (data) {\r\n    if (this.composer.fields.lottery) {\r\n      data.lottery = this.composer.fields.lottery;\r\n    }\r\n  });\r\n};\r\n\r\nexport default () => {\r\n  addToComposer(DiscussionComposer);\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/CommentPost'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/LogInModal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/avatar'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/username'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Link'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/LoadingIndicator'];","import app from 'flarum/forum/app';\n\nimport Modal from 'flarum/common/components/Modal';\nimport avatar from 'flarum/common/helpers/avatar';\nimport username from 'flarum/common/helpers/username';\nimport Link from 'flarum/common/components/Link';\nimport Stream from 'flarum/common/utils/Stream';\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\n\nexport default class ListLotteryModal extends Modal {\n  oninit(vnode) {\n    super.oninit(vnode);\n    this.loading = Stream(true);\n    app.store\n      .find('nodeloc/lottery', this.attrs.lottery.id(), {\n        include: 'participants,participants.user,participants.status',\n      })\n      .then(() => this.loading(false))\n      .finally(() => m.redraw());\n  }\n\n  className() {\n    return 'Modal--medium ParticipantsModal';\n  }\n\n  title() {\n    return app.translator.trans('nodeloc-lottery.forum.participants_modal.title' + (this.attrs.lottery.hasEnded() ? '_winners':''));\n  }\n\n  content() {\n    return <div className=\"Modal-body\">{this.loading() ? <LoadingIndicator /> : this.optionContent()}</div>;\n  }\n\n  optionContent() {\n    const participants = this.attrs.lottery.participants();\n\n    // 如果抽奖已经结束，显示获奖者\n    if (this.attrs.lottery.hasEnded()) {\n        return (\n            <div>\n              <h2>{this.attrs.lottery.status() ==1 ?app.translator.trans('nodeloc-lottery.forum.participants_modal.title_winners'):app.translator.trans('nodeloc-lottery.forum.participants_modal.lottery_canceled')}</h2>\n              <div className=\"ParticipantsModal-option\">\n                  {participants.length ? (\n                      <div className=\"ParticipantsModal-list\">{participants.map(this.winnerContent.bind(this))}</div>\n                  ) : (\n                      <h4>{app.translator.trans('nodeloc-lottery.forum.modal.no_participants')}</h4>\n                  )}\n              </div>\n              <h2>{app.translator.trans('nodeloc-lottery.forum.participants_modal.title')}</h2>\n              <div className=\"ParticipantsModal-option\">\n                  {participants.length ? (\n                      <div className=\"ParticipantsModal-list\">{participants.map(this.participantsContent.bind(this))}</div>\n                  ) : (\n                      <h4>{app.translator.trans('nodeloc-lottery.forum.modal.no_participants')}</h4>\n                  )}\n              </div>\n            </div>\n        );\n    } else { // 抽奖未结束，显示参与者\n        return (\n            <div>\n                <h2>{app.translator.trans('nodeloc-lottery.forum.participants_modal.title')}</h2>\n                <div className=\"ParticipantsModal-option\">\n                    {participants.length ? (\n                        <div className=\"ParticipantsModal-list\">{participants.map(this.participantsContent.bind(this))}</div>\n                    ) : (\n                        <h4>{app.translator.trans('nodeloc-lottery.forum.modal.no_participants')}</h4>\n                    )}\n                </div>\n            </div>\n        );\n    }\n}\n\n\n  winnerContent(participants) {\n    const user = participants.user();\n    // 只在 hasEnded 为 true 时显示 status=1 的用户\n    if (this.attrs.lottery.hasEnded() && participants.status() !== 1) {\n      return '';\n    }\n    const attrs = user && { href: app.route.user(user) };\n\n    return (\n      <Link {...attrs}>\n        {avatar(user)} {username(user)}\n      </Link>\n    );\n  }\n\n  participantsContent(participants) {\n    const user = participants.user();\n    const attrs = user && { href: app.route.user(user) };\n\n    return (\n      <Link {...attrs}>\n        {avatar(user)} {username(user)}\n      </Link>\n    );\n  }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Tooltip'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/helpers/icon'];","import app from 'flarum/forum/app';\r\n\r\nimport Button from 'flarum/common/components/Button';\r\nimport Stream from 'flarum/common/utils/Stream';\r\nimport extractText from 'flarum/common/utils/extractText';\r\nimport CreateLotteryModal from './CreateLotteryModal';\r\nimport Select from \"flarum/common/components/Select\";\r\n\r\nexport default class EditLotteryModal extends CreateLotteryModal {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.lottery = this.attrs.lottery;\r\n\r\n    this.options = this.lottery.options();\r\n    this.operator_type = this.options.map((o) => Stream(o.operator_type()));\r\n    this.operator = this.options.map((o) => Stream(o.operator()));\r\n    this.operator_value = this.options.map((o) => Stream(o.operator_value()));\r\n    this.prizes = Stream(this.lottery.prizes());\r\n    this.price = Stream(this.lottery.price());\r\n    this.amount = Stream(this.lottery.amount());\r\n    this.endDate = Stream(this.formatDate(this.lottery.endDate()));\r\n    this.min_participants = Stream(this.lottery.min_participants() || 0);\r\n    this.max_participants = Stream(this.lottery.max_participants() || 999999);\r\n\r\n    if (this.endDate() && dayjs(this.lottery.endDate()).isAfter(dayjs())) {\r\n      this.datepickerMinDate = this.formatDate(this.endDate());\r\n    }\r\n  }\r\n\r\n  title() {\r\n    return app.translator.trans('nodeloc-lottery.forum.modal.edit_title');\r\n  }\r\n\r\n  displayOptions() {\r\n    return this.options.map((options, i) => (\r\n        <div className=\"Form-group MinMaxSelector\">\r\n          <fieldset className=\"MinMaxSelector--inputs\">\r\n          <span class=\"Select\">\r\n            {Select.component({\r\n              options: this.select_options,\r\n              value: this.operator_type[i](),\r\n              onchange: (value) => {\r\n                this.operator_type[i](value);\r\n              },\r\n            })}\r\n            <i aria-hidden=\"true\" class=\"icon fas fa-sort Select-caret\"></i></span>\r\n            <button class=\"Button hasIcon\" type=\"button\"\r\n                    onclick={() => this.operator[i](this.operator[i]() === 0 ? 1 : 0)}>\r\n              {this.operator[i]() === 0 ? (\r\n                  <i aria-hidden=\"true\" class=\"icon fas fa-less-than-equal Button-icon\"></i>\r\n              ) : (\r\n                  <i aria-hidden=\"true\" class=\"icon fas fa-greater-than-equal Button-icon\"></i>\r\n              )}\r\n              <span class=\"Button-label\"></span>\r\n            </button>\r\n\r\n            <input\r\n                className=\"FormControl\"\r\n                type=\"number\"\r\n                name={'operatorvalue' + (i + 1)}\r\n                bidi={this.operator_value[i]}\r\n                placeholder={app.translator.trans('nodeloc-lottery.forum.modal.option_placeholder') + ' #' + (i + 1)}\r\n            />\r\n          </fieldset>\r\n          {i >= 2\r\n              ? Button.component({\r\n                type: 'button',\r\n                className: 'Button Button--warning LotteryModal--button',\r\n                icon: 'fas fa-minus',\r\n                onclick: i >= 1 ? this.removeOption.bind(this, i) : '',\r\n              })\r\n              : ''}\r\n      </div>\r\n    ));\r\n  }\r\n  addOption() {\r\n    const max = 5;\r\n    if (this.operator_value.length < max) {\r\n      this.operator_type.push(Stream(''));\r\n      this.operator.push(Stream(''));\r\n      this.operator_value.push(Stream(''));\r\n      this.displayOptions();\r\n    } else {\r\n      alert(extractText(app.translator.trans('nodeloc-lottery.forum.modal.max', {max})));\r\n    }\r\n  }\r\n\r\n  removeOption(option) {\r\n    this.operator_type.splice(option, 1);\r\n    this.operator.splice(option, 1);\r\n    this.operator_value.splice(option, 1);\r\n  }\r\n\r\n  data() {\r\n    const options = this.options.map((o, i) => {\r\n      if (!o.data.attributes) o.data.attributes = {};\r\n\r\n      o.data.attributes.operator_type = this.operator_type[i]();\r\n      o.data.attributes.operator = this.operator[i]();\r\n      o.data.attributes.operator_value = this.operator_value[i]();\r\n\r\n      return o.data;\r\n    });\r\n\r\n    return {\r\n      prizes: this.prizes(),\r\n      price: this.price(),\r\n      amount: this.amount(),\r\n      endDate: this.dateToTimestamp(this.endDate()),\r\n      min_participants: this.min_participants(),\r\n      max_participants: this.max_participants(),\r\n      options,\r\n    };\r\n  }\r\n\r\n  onsubmit(e) {\r\n    e.preventDefault();\r\n\r\n    if (this.loading) return;\r\n\r\n    this.loading = true;\r\n\r\n    return this.lottery\r\n      .save(this.data())\r\n      .then(() => {\r\n        this.hide();\r\n        m.redraw();\r\n      })\r\n      .catch((e) => {\r\n        this.loaded();\r\n        this.onerror(e);\r\n      });\r\n  }\r\n}\r\n","import app from 'flarum/forum/app';\r\nimport Component from 'flarum/common/Component';\r\nimport Stream from 'flarum/common/utils/Stream';\r\n\r\nexport default class EventCountDown extends Component {\r\n    oninit(vnode) {\r\n        vnode.state.days = Stream();\r\n        vnode.state.hours = Stream();\r\n        vnode.state.minutes = Stream();\r\n        vnode.state.seconds = Stream();\r\n    }\r\n    oncreate(vnode) {\r\n        var deadline = vnode.attrs.endDate;\r\n\r\n        function time_remaining(endtime) {\r\n            var t = Date.parse(endtime) - Date.parse(new Date());\r\n            var seconds = Math.floor((t / 1000) % 60);\r\n            var minutes = Math.floor((t / 1000 / 60) % 60);\r\n            var hours = Math.floor((t / (1000 * 60 * 60)) % 24);\r\n            var days = Math.floor(t / (1000 * 60 * 60 * 24));\r\n            return {total: t, days: days, hours: hours, minutes: minutes, seconds: seconds};\r\n        }\r\n\r\n        function run_clock(id, endtime) {\r\n            var clock = document.getElementById(id);\r\n\r\n            // get spans where our clock numbers are held\r\n            var days_span = clock.querySelector('.days');\r\n            var hours_span = clock.querySelector('.hours');\r\n            var minutes_span = clock.querySelector('.minutes');\r\n            var seconds_span = clock.querySelector('.seconds');\r\n\r\n            function update_clock() {\r\n                var t = time_remaining(deadline);\r\n                days_span.innerHTML = t.days;\r\n                hours_span.innerHTML = ('0' + t.hours).slice(-2);\r\n                minutes_span.innerHTML = ('0' + t.minutes).slice(-2);\r\n                seconds_span.innerHTML = ('0' + t.seconds).slice(-2);\r\n                if (t.total < 0) {\r\n                    clearInterval(timeinterval);\r\n                    if (document.getElementById('titleEvent')) {\r\n                        var elem = document.getElementById('titleEvent');\r\n                        elem.parentNode.removeChild(elem);\r\n                    }\r\n                    var finishText = app.translator.trans('nodeloc-lottery.forum.endDateText');\r\n                    var finishDiv = document.getElementById('clockdiv');\r\n                    finishDiv.innerHTML = '<h1 class=\"letterpress\">' + finishText + '</h1>';\r\n                }\r\n            }\r\n\r\n            update_clock();\r\n            var timeinterval = setInterval(() => update_clock(), 1000);\r\n        }\r\n        run_clock('clockdiv', deadline);\r\n\r\n    }\r\n    view(vnode) {\r\n        const wgDays = app.translator.trans('nodeloc-lottery.forum.days');\r\n        const wgHours = app.translator.trans('nodeloc-lottery.forum.hours');\r\n        const wgMinutes = app.translator.trans('nodeloc-lottery.forum.minutes');\r\n        const wgSeconds = app.translator.trans('nodeloc-lottery.forum.seconds');\r\n        const wgEvents = app.forum.attribute('event_title') || app.translator.trans('nodeloc-lottery.forum.hurry_up');\r\n        const fontAwIcon = app.forum.attribute('fontawesome_events_icon') || 'fas fa-gift';\r\n\r\n        return (\r\n            <div class=\"countdown-container\">\r\n                <h2 class=\"event-text\" id=\"titleEvent\"><i class={fontAwIcon + \" \" + 'fontawicon'}></i>{wgEvents}</h2>\r\n                <div id=\"clockdiv\">\r\n                    <div class=\"cntdwn-widget\">\r\n                        <span class=\"days\">{vnode.state.days()}</span>\r\n                        <div class=\"smalltext\">{wgDays}</div>\r\n                    </div>\r\n                    <div class=\"cntdwn-widget\">\r\n                        <span class=\"hours\">{vnode.state.hours()}</span>\r\n                        <div class=\"smalltext\">{wgHours}</div>\r\n                    </div>\r\n                    <div class=\"cntdwn-widget\">\r\n                        <span class=\"minutes\">{vnode.state.minutes()}</span>\r\n                        <div class=\"smalltext\">{wgMinutes}</div>\r\n                    </div>\r\n                    <div class=\"cntdwn-widget\">\r\n                        <span class=\"seconds\">{vnode.state.seconds()}</span>\r\n                        <div class=\"smalltext\">{wgSeconds}</div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import app from 'flarum/forum/app';\r\n\r\nimport Component from 'flarum/common/Component';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LogInModal from 'flarum/forum/components/LogInModal';\r\nimport ListLotteryModal from './ListLotteryModal';\r\nimport classList from 'flarum/common/utils/classList';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport Tooltip from 'flarum/common/components/Tooltip';\r\nimport icon from 'flarum/common/helpers/icon';\r\nimport EditLotteryModal from './EditLotteryModal';\r\nimport EventCountDown from \"./EventCountDown\"; // You need to implement a Countdown component for displaying the countdown\r\n\r\nexport default class PostLottery extends Component {\r\n  oninit(vnode) {\r\n    super.oninit(vnode);\r\n\r\n    this.loadingOptions = false;\r\n    this.useSubmitUI = !this.attrs.lottery?.canCancelEnter() && this.attrs.lottery;\r\n    this.pendingSubmit = false;\r\n  }\r\n\r\n  oncreate(vnode) {\r\n    super.oncreate(vnode);\r\n  }\r\n\r\n  onremove(vnode) {\r\n    super.onremove(vnode);\r\n  }\r\n\r\n  view() {\r\n    const lottery = this.attrs.lottery;\r\n    const options = lottery.options() || [];\r\n    const infoItems = this.infoItems();\r\n    const endDate = dayjs(lottery.endDate());\r\n    const hasEntered = lottery.lottery_participants()?.length > 0;\r\n    return (\r\n      <div className=\"Post-lottery\" data-id={lottery.id()}>\r\n        <div className=\"LotteryHeading\">\r\n          <h3 className=\"LotteryHeading-title\">{lottery.prizes()}</h3>\r\n            <Tooltip text={app.translator.trans('nodeloc-lottery.forum.public_lottery')}>\r\n              <Button className=\"Button LotteryHeading-voters\" onclick={this.showparticipants.bind(this)} icon=\"fas fa-user\" />\r\n            </Tooltip>\r\n          {lottery.canEdit() && (\r\n            <Tooltip text={app.translator.trans('nodeloc-lottery.forum.moderation.edit')}>\r\n              <Button className=\"Button LotteryHeading-edit\" onclick={app.modal.show.bind(app.modal, EditLotteryModal, { lottery })} icon=\"fas fa-pen\" />\r\n            </Tooltip>\r\n          )}\r\n          {lottery.canDelete() && (\r\n            <Tooltip text={app.translator.trans('nodeloc-lottery.forum.moderation.delete')}>\r\n              <Button className=\"Button LotteryHeading-delete\" onclick={this.deleteLottery.bind(this)} icon=\"fas fa-trash\" />\r\n            </Tooltip>\r\n          )}\r\n        </div>\r\n        <div>\r\n          <div className=\"PrizeInfo\">\r\n            <div className=\"PrizeDetails\">\r\n              <span class='amount'>{app.translator.trans('nodeloc-lottery.forum.modal.amount')} </span>\r\n              <span>{lottery.amount()}</span>\r\n              <span class='price'>{app.translator.trans('nodeloc-lottery.forum.modal.price')}</span>\r\n              <span>{lottery.price()}</span>\r\n              {lottery.min_participants()!==0 &&(<>\r\n                <span class='min_participants'>{app.translator.trans('nodeloc-lottery.forum.modal.min_participants')}</span><span>{lottery.min_participants()}</span></>)}\r\n              {lottery.max_participants()<9999 &&(<>\r\n                <span class='min_participants'>{app.translator.trans('nodeloc-lottery.forum.modal.max_participants')}</span><span>{lottery.max_participants()}</span></>)}\r\n            </div>\r\n            <EventCountDown endDate={endDate} />\r\n          </div>\r\n          <div className=\"LotteryOptions\">\r\n            {\r\n                lottery.min_participants() > 0 && lottery.enterCount() && m('.arrow', [\r\n                  m('.arrow-status', {\r\n                    style: {\r\n                      width: (lottery.enterCount() > lottery.min_participants()) ? '100%' : ((lottery.enterCount() / lottery.min_participants()) * 100 + '%')\r\n                    }\r\n                  }, [\r\n                    m('span.arrow-pointer', '已有' + lottery.enterCount() + '人 / 最低' + lottery.min_participants() + '人')\r\n                  ])\r\n                ])\r\n            }\r\n            <h2><i class='fas fa-info-circle fontawicon'></i> {app.translator.trans('nodeloc-lottery.forum.modal.options_label')}</h2>\r\n            <ul>\r\n            {options.map(this.viewOption.bind(this))}\r\n            </ul>\r\n          </div>\r\n          <div className=\"Lottery-sticky\">\r\n            {!infoItems.isEmpty() && <div className=\"helpText LotteryInfoText\">{infoItems.toArray()}</div>}\r\n            {this.useSubmitUI && !hasEntered &&(\r\n              <Button className=\"Button Button--primary Lottery-submit\" loading={this.loadingOptions} onclick={this.onsubmit.bind(this)}>\r\n                {app.translator.trans('nodeloc-lottery.forum.lottery.submit_button')}\r\n              </Button>\r\n            )}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  infoItems() {\r\n    const items = new ItemList();\r\n    const lottery = this.attrs.lottery;\r\n    const hasEntered = lottery.lottery_participants()?.length > 0;\r\n\r\n    if (app.session.user && !lottery.canEnter() && !lottery.hasEnded()) {\r\n      items.add(\r\n        'no-permission',\r\n        <span>\r\n          <i className=\"icon fas fa-times-circle fa-fw\" />\r\n          {app.translator.trans('nodeloc-lottery.forum.no_permission')}\r\n        </span>\r\n      );\r\n    }\r\n\r\n    if (lottery.endDate()) {\r\n      items.add(\r\n        'end-date',\r\n        <span>\r\n          <i class=\"icon fas fa-clock fa-fw\" />\r\n          {lottery.hasEnded()\r\n            ? app.translator.trans('nodeloc-lottery.forum.lottery_ended')\r\n            : app.translator.trans('nodeloc-lottery.forum.days_remaining', { time: dayjs(lottery.endDate()).fromNow() })}\r\n        </span>\r\n      );\r\n    }\r\n\r\n    if (hasEntered) {\r\n      items.add(\r\n          'had-enter',\r\n          <span>\r\n          <i class=\"icon fas fa-check-double fa-fw\" />\r\n          {app.translator.trans('nodeloc-lottery.forum.had_enter')}\r\n        </span>\r\n      );\r\n    }\r\n    return items;\r\n  }\r\n\r\n  select_options = {\r\n    discussions_started: app.translator.trans('nodeloc-lottery.forum.modal.discussions_started'),\r\n    posts_made: app.translator.trans('nodeloc-lottery.forum.modal.posts_made'),\r\n    //likes_received: app.translator.trans('nodeloc-lottery.forum.modal.likes_received'),\r\n    //best_answers: app.translator.trans('nodeloc-lottery.forum.modal.best_answers'),\r\n    //moderator_strikes: app.translator.trans('nodeloc-lottery.forum.modal.moderator_strikes'),\r\n    money: app.translator.trans('nodeloc-lottery.forum.modal.money'),\r\n    lotteries_made: app.translator.trans('nodeloc-lottery.forum.modal.lotteries_made'),\r\n  };\r\n\r\n  viewOption(opt) {\r\n    const operatorText = this.select_options[opt.operator_type()] || '';\r\n    const operatorSymbol = opt.operator() === 0 ? '<' : '>';\r\n    return (\r\n        <li>{operatorText}{operatorSymbol}{opt.operator_value()}</li>\r\n    );\r\n  }\r\n\r\n  onsubmit() {\r\n    if (!app.session.user) {\r\n      app.modal.show(LogInModal);\r\n      return;\r\n    }\r\n    return this.submit( () => {\r\n      this.pendingSubmit = false;\r\n    });\r\n  }\r\n\r\n  submit(optionIds, cb, onerror) {\r\n    this.loadingOptions = true;\r\n\r\n    m.redraw();\r\n    return app\r\n      .request({\r\n        method: 'PATCH',\r\n        url: `${app.forum.attribute('apiUrl')}/nodeloc/lottery/${this.attrs.lottery.id()}/enter`,\r\n      })\r\n      .then((res) => {\r\n        app.store.pushPayload(res);\r\n        cb?.();\r\n      })\r\n      .catch((err) => {\r\n        onerror?.(err);\r\n      })\r\n      .finally(() => {\r\n        this.loadingOptions = false;\r\n\r\n        m.redraw();\r\n      });\r\n  }\r\n\r\n  showparticipants() {\r\n    // Load all the votes only when opening the votes list\r\n    app.modal.show(ListLotteryModal, {\r\n      lottery: this.attrs.lottery,\r\n      post: this.attrs.post,\r\n    });\r\n  }\r\n\r\n  deleteLottery() {\r\n    if (confirm(app.translator.trans('nodeloc-lottery.forum.moderation.delete_confirm'))) {\r\n      this.attrs.lottery.delete().then(() => {\r\n        m.redraw.sync();\r\n      });\r\n    }\r\n  }\r\n}\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/DiscussionPage'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/utils/PostControls'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/Notification'];","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class FailLotteryNotification extends Notification {\n  icon() {\n    return 'fas fa-exclamation-triangle';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('nodeloc-lottery.forum.notification.fail');\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class FinishLotteryNotification extends Notification {\n  icon() {\n    return 'fas fa-check';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    return app.translator.trans('nodeloc-lottery.forum.notification.finish');\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import app from 'flarum/forum/app';\nimport Notification from 'flarum/forum/components/Notification';\n\nexport default class DrawLotteryNotification extends Notification {\n  icon() {\n    return 'fas fa-trophy';\n  }\n\n  href() {\n    const notification = this.attrs.notification;\n    const discussion = notification.subject();\n\n    return app.route.discussion(discussion);\n  }\n\n  content() {\n    const user = this.attrs.notification.fromUser();\n    return app.translator.trans('nodeloc-lottery.forum.notification.drawLottery', {\n      user: user,\n    });\n  }\n\n  excerpt() {\n    return null;\n  }\n}\n","import CreateLotteryModal from './CreateLotteryModal';\r\nimport PostLottery from './PostLottery';\r\nimport EditLotteryModal from './EditLotteryModal';\r\nimport ListLotteryModal from './ListLotteryModal';\r\n\r\nexport const components = {\r\n  CreateLotteryModal: CreateLotteryModal,\r\n  PostLottery: PostLottery,\r\n  EditLotteryModal: EditLotteryModal,\r\n  ListVotersModal: ListLotteryModal,\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","import Model from 'flarum/common/Model';\r\n\r\nexport default class Lottery extends Model {\r\n  prizes = Model.attribute('prizes');\r\n  hasEnded = Model.attribute('hasEnded');\r\n  endDate = Model.attribute('endDate');\r\n\r\n  price = Model.attribute('price');\r\n  amount = Model.attribute('amount');\r\n  min_participants = Model.attribute('min_participants');\r\n  max_participants = Model.attribute('max_participants');\r\n\r\n  enterCount = Model.attribute('enter_count');\r\n  status = Model.attribute('status');\r\n  canEnter = Model.attribute('canEnter');\r\n  canEdit = Model.attribute('canEdit');\r\n  canDelete = Model.attribute('canDelete');\r\n  canSeeParticipants = Model.attribute('canSeeParticipants');\r\n  canCancelEnter = Model.attribute('can_cancel_enter');\r\n\r\n  options = Model.hasMany('options');\r\n  participants = Model.hasMany('participants');\r\n  lottery_participants = Model.hasMany('lottery_participants');\r\n\r\n  apiEndpoint() {\r\n    return `/nodeloc/lottery${this.exists ? `/${this.data.id}` : ''}`;\r\n  }\r\n}\r\n","import Model from 'flarum/common/Model';\r\n\r\nexport default class LotteryOption extends Model {\r\n  operator_type = Model.attribute('operator_type');\r\n  operator = Model.attribute('operator');\r\n  operator_value = Model.attribute('operator_value');\r\n\r\n  lottery = Model.hasOne('lottery');\r\n\r\n  apiEndpoint() {\r\n    return `/nodeloc/lottery/operator${this.exists ? `/${this.data.id}` : ''}`;\r\n  }\r\n}\r\n","import Model from 'flarum/common/Model';\r\n\r\nexport default class LotteryParticipants extends Model {\r\n  lottery = Model.hasOne('lottery');\r\n  user = Model.hasOne('user');\r\n  status = Model.attribute('status');\r\n  lotteryId = Model.attribute('lotteryId');\r\n\r\n  apiEndpoint() {\r\n    return `/nodeloc/lottery/${this.lotteryId()}/enter`;\r\n  }\r\n}\r\n","import Lottery from './Lottery';\r\nimport LotteryOption from './LotteryOption';\r\nimport LotteryParticipants from './LotteryParticipants';\r\n\r\nexport const models = {\r\n  Lottery: Lottery,\r\n  LotteryOption: LotteryOption,\r\n  LotteryParticipants: LotteryParticipants,\r\n};\r\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extenders'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Post'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/models/Forum'];","import Extend from 'flarum/common/extenders';\nimport Post from 'flarum/common/models/Post';\nimport Forum from 'flarum/common/models/Forum';\nimport Discussion from 'flarum/common/models/Discussion';\nimport Lottery from './models/Lottery';\nimport LotteryOption from './models/LotteryOption';\nimport LotteryParticipants from './models/LotteryParticipants';\n\nexport default [\n  new Extend.Store().add('lottery', Lottery).add('lottery_options', LotteryOption).add('lottery_participants', LotteryParticipants),\n  new Extend.Model(Post).hasOne('lottery').attribute('canStartLottery'),\n  new Extend.Model(Forum).attribute('canStartLottery'),\n  new Extend.Model(Discussion).attribute('hasLottery').attribute('canStartLottery'),\n];\n","import app from 'flarum/forum/app';\n\nimport addDiscussionBadge from './addDiscussionBadge';\nimport addComposerItems from './addComposerItems';\nimport addLotteryToPost from './addLotteryToPost';\nimport addLotteryControls from './addLotteryControls';\nimport FailLotteryNotification from './components/FailLotteryNotification';\nimport FinishLotteryNotification from './components/FinishLotteryNotification';\nimport DrawLotteryNotification from './components/DrawLotteryNotification';\n\nexport * from './components';\nexport * from './models';\n\napp.initializers.add('nodeloc/lottery', () => {\n  addDiscussionBadge();\n  addComposerItems();\n  addLotteryToPost();\n  addLotteryControls();\n  app.notificationComponents.drawLottery = DrawLotteryNotification;\n  app.notificationComponents.failLottery = FailLotteryNotification;\n  app.notificationComponents.finishLottery = FinishLotteryNotification;\n});\n\nexport { default as extend } from './extend';\n","import app from 'flarum/forum/app';\n\nimport { extend } from 'flarum/common/extend';\nimport CommentPost from 'flarum/forum/components/CommentPost';\nimport PostLottery from './components/PostLottery';\nimport DiscussionPage from 'flarum/forum/components/DiscussionPage';\n\nexport default () => {\n  extend(CommentPost.prototype, 'content', function (content) {\n    const post = this.attrs.post;\n\n    if ((!post.isHidden() || this.revealContent) && post.lottery()) {\n        if (post.lottery()) {\n          content.push(<PostLottery post={post} lottery={post.lottery()} />);\n        }\n    }\n  });\n};\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","CreateLotteryModal","_Modal","_this","_len","arguments","length","args","Array","_key","apply","concat","select_options","discussions_started","app","trans","posts_made","money","lotteries_made","_proto","oninit","vnode","_this2","this","operator_type","Stream","operator","operator_value","prizes","price","amount","endDate","allowCancleEnter","min_participants","max_participants","datepickerMinDate","formatDate","undefined","lottery","attrs","isArray","options","forEach","option","push","dayjs","isAfter","title","className","content","m","fields","toArray","items","ItemList","add","type","name","bidi","min","Button","icon","onclick","addOption","displayOptions","max","class","isBefore","time","fromNow","disabled","placeholder","loading","_this3","keys","map","el","i","Select","onchange","removeOption","alert","extractText","splice","data","_this4","dateToTimestamp","allowCancelEnter","opvalue","index","onsubmit","e","_this5","preventDefault","promise","Promise","then","hide","err","console","error","onerror","loaded","close","date","def","dayjsDate","isValid","format","Modal","ListLotteryModal","find","id","include","redraw","hasEnded","LoadingIndicator","optionContent","participants","status","winnerContent","participantsContent","user","href","Link","avatar","username","EditLotteryModal","_CreateLotteryModal","attributes","save","EventCountDown","_Component","state","days","hours","minutes","seconds","oncreate","deadline","endtime","clock","document","getElementById","days_span","querySelector","hours_span","minutes_span","seconds_span","update_clock","t","Date","parse","Math","floor","total","time_remaining","innerHTML","slice","clearInterval","timeinterval","elem","parentNode","removeChild","finishText","setInterval","run_clock","view","wgDays","wgHours","wgMinutes","wgSeconds","wgEvents","attribute","fontAwIcon","Component","PostLottery","_this$attrs$lottery","loadingOptions","useSubmitUI","canCancelEnter","pendingSubmit","onremove","_lottery$lottery_part","infoItems","hasEntered","lottery_participants","Tooltip","text","showparticipants","canEdit","show","canDelete","deleteLottery","'['","enterCount","style","width","viewOption","isEmpty","_lottery$lottery_part2","canEnter","opt","operatorText","operatorSymbol","submit","LogInModal","optionIds","cb","method","url","res","pushPayload","post","confirm","sync","FailLotteryNotification","_Notification","discussion","notification","subject","fromUser","excerpt","Notification","FinishLotteryNotification","DrawLotteryNotification","components","ListVotersModal","Lottery","_Model","Model","canSeeParticipants","apiEndpoint","exists","LotteryOption","LotteryParticipants","lotteryId","models","Extend","Post","hasOne","Forum","Discussion","composer","extend","DiscussionList","params","badges","hasLottery","Badge","label","DiscussionComposer","addLottery","_this$composer$body","_discussion$canStartL","body","canStartLottery","classList","CommentPost","isHidden","revealContent","drawLottery","failLottery","finishLottery"],"sourceRoot":""}